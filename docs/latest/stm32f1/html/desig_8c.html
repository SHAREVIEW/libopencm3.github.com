<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libopencm3: desig.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libopencm3
   </div>
   <div id="projectbrief">A free/libre/open-source firmware library for various ARM Cortex-M3 microcontrollers.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('desig_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">desig.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="desig_8h_source.html">libopencm3/stm32/desig.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for desig.c:</div>
<div class="dyncontent">
<div class="center"><img src="desig_8c__incl.png" border="0" usemap="#desig_8c" alt=""/></div>
<map name="desig_8c" id="desig_8c">
<area shape="rect" id="node2" href="desig_8h.html" title="libopencm3/stm32/desig.h" alt="" coords="120,80,295,107"/>
<area shape="rect" id="node3" href="common_8h.html" title="libopencm3/cm3/common.h" alt="" coords="5,155,188,181"/>
<area shape="rect" id="node6" href="stm32_2memorymap_8h.html" title="libopencm3/stm32/memorymap.h" alt="" coords="212,155,427,181"/>
</map>
</div>
</div>
<p><a href="desig_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3dd3e16f359d093b546f5c9e3cde1957"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="desig_8c.html#a3dd3e16f359d093b546f5c9e3cde1957">desig_get_flash_size</a> (void)</td></tr>
<tr class="memdesc:a3dd3e16f359d093b546f5c9e3cde1957"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the on board flash size.  <a href="#a3dd3e16f359d093b546f5c9e3cde1957">More...</a><br /></td></tr>
<tr class="separator:a3dd3e16f359d093b546f5c9e3cde1957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cd0901d044d03766a710d05a2e6cd13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="desig_8c.html#a3cd0901d044d03766a710d05a2e6cd13">desig_get_unique_id</a> (uint32_t *result)</td></tr>
<tr class="memdesc:a3cd0901d044d03766a710d05a2e6cd13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the full 96 bit unique identifier Note: ST specifies that bits 31..16 are <em>also</em> reserved for future use.  <a href="#a3cd0901d044d03766a710d05a2e6cd13">More...</a><br /></td></tr>
<tr class="separator:a3cd0901d044d03766a710d05a2e6cd13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a552ad9c91201643dadccf3044ce0f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="desig_8c.html#a8a552ad9c91201643dadccf3044ce0f5">desig_get_unique_id_as_string</a> (char *string, unsigned int string_len)</td></tr>
<tr class="memdesc:a8a552ad9c91201643dadccf3044ce0f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the full 96 bit unique identifier and return it as a zero-terminated string.  <a href="#a8a552ad9c91201643dadccf3044ce0f5">More...</a><br /></td></tr>
<tr class="separator:a8a552ad9c91201643dadccf3044ce0f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1965f5faba844391efa3f6e046d42e31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="desig_8c.html#a1965f5faba844391efa3f6e046d42e31">desig_get_unique_id_as_dfu</a> (char *string)</td></tr>
<tr class="memdesc:a1965f5faba844391efa3f6e046d42e31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a serial number from the unique id registers as the DFU bootloader.  <a href="#a1965f5faba844391efa3f6e046d42e31">More...</a><br /></td></tr>
<tr class="separator:a1965f5faba844391efa3f6e046d42e31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3dd3e16f359d093b546f5c9e3cde1957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dd3e16f359d093b546f5c9e3cde1957">&#9670;&nbsp;</a></span>desig_get_flash_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t desig_get_flash_size </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the on board flash size. </p>
<dl class="section return"><dt>Returns</dt><dd>flash size in KB </dd></dl>

<p class="definition">Definition at line <a class="el" href="desig_8c_source.html#l00022">22</a> of file <a class="el" href="desig_8c_source.html">desig.c</a>.</p>

<p class="reference">References <a class="el" href="desig_8h_source.html#l00029">DESIG_FLASH_SIZE</a>.</p>

</div>
</div>
<a id="a3cd0901d044d03766a710d05a2e6cd13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cd0901d044d03766a710d05a2e6cd13">&#9670;&nbsp;</a></span>desig_get_unique_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void desig_get_unique_id </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>result</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the full 96 bit unique identifier Note: ST specifies that bits 31..16 are <em>also</em> reserved for future use. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">result</td><td>pointer to at least 3xuint32_ts (96 bits) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="desig_8c_source.html#l00027">27</a> of file <a class="el" href="desig_8c_source.html">desig.c</a>.</p>

<p class="reference">References <a class="el" href="stm32_2f1_2memorymap_8h_source.html#l00123">DESIG_UNIQUE_ID0</a>, <a class="el" href="stm32_2f1_2memorymap_8h_source.html#l00124">DESIG_UNIQUE_ID1</a>, and <a class="el" href="stm32_2f1_2memorymap_8h_source.html#l00125">DESIG_UNIQUE_ID2</a>.</p>

<p class="reference">Referenced by <a class="el" href="desig_8c_source.html#l00034">desig_get_unique_id_as_string()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="desig_8c_a3cd0901d044d03766a710d05a2e6cd13_icgraph.png" border="0" usemap="#desig_8c_a3cd0901d044d03766a710d05a2e6cd13_icgraph" alt=""/></div>
<map name="desig_8c_a3cd0901d044d03766a710d05a2e6cd13_icgraph" id="desig_8c_a3cd0901d044d03766a710d05a2e6cd13_icgraph">
<area shape="rect" id="node2" href="desig_8c.html#a8a552ad9c91201643dadccf3044ce0f5" title="Read the full 96 bit unique identifier and return it as a zero&#45;terminated string. ..." alt="" coords="193,5,333,47"/>
</map>
</div>

</div>
</div>
<a id="a1965f5faba844391efa3f6e046d42e31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1965f5faba844391efa3f6e046d42e31">&#9670;&nbsp;</a></span>desig_get_unique_id_as_dfu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void desig_get_unique_id_as_dfu </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>string</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a serial number from the unique id registers as the DFU bootloader. </p>
<p>Returns the same serial number that the factory DFU bootloader reports (via USB descriptors).</p>
<p>This document: <a href="http://www.usb.org/developers/docs/devclass_docs/usbmassbulk_10.pdf">http://www.usb.org/developers/docs/devclass_docs/usbmassbulk_10.pdf</a> says that the serial number has to be at least 12 digits long and that the last 12 digits need to be unique. It also stipulates that the valid character set is that of upper-case hexadecimal digits. The onboard DFU bootloader produces a 12-digit serial based on the 96-bit unique ID. Show the serial with <code>dfu-util -l</code> while the MCU is in DFU mode. </p><dl class="section see"><dt>See also</dt><dd><a href="https://my.st.com/52d187b7">https://my.st.com/52d187b7</a> for the algorithim used. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">string</td><td>pointer to store serial in, must be at least 13 bytes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="desig_8c_source.html#l00068">68</a> of file <a class="el" href="desig_8c_source.html">desig.c</a>.</p>

<p class="reference">References <a class="el" href="stm32_2f1_2memorymap_8h_source.html#l00121">DESIG_UNIQUE_ID_BASE</a>.</p>

</div>
</div>
<a id="a8a552ad9c91201643dadccf3044ce0f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a552ad9c91201643dadccf3044ce0f5">&#9670;&nbsp;</a></span>desig_get_unique_id_as_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void desig_get_unique_id_as_string </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>string_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the full 96 bit unique identifier and return it as a zero-terminated string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">string</td><td>memory region to write the result to </td></tr>
    <tr><td class="paramname">string_len</td><td>the size of string in bytes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="desig_8c_source.html#l00034">34</a> of file <a class="el" href="desig_8c_source.html">desig.c</a>.</p>

<p class="reference">References <a class="el" href="desig_8c_source.html#l00027">desig_get_unique_id()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="desig_8c_a8a552ad9c91201643dadccf3044ce0f5_cgraph.png" border="0" usemap="#desig_8c_a8a552ad9c91201643dadccf3044ce0f5_cgraph" alt=""/></div>
<map name="desig_8c_a8a552ad9c91201643dadccf3044ce0f5_cgraph" id="desig_8c_a8a552ad9c91201643dadccf3044ce0f5_cgraph">
<area shape="rect" id="node2" href="desig_8c.html#a3cd0901d044d03766a710d05a2e6cd13" title="Read the full 96 bit unique identifier Note: ST specifies that bits 31..16 are also reserved for futu..." alt="" coords="193,13,333,39"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_4ec17005d2b9378bd9434f3627484c7d.html">stm32</a></li><li class="navelem"><a class="el" href="desig_8c.html">desig.c</a></li>
    <li class="footer">Generated on Wed Aug 28 2019 23:10:51 for libopencm3 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
